<!-- test.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>実験 - テスト</title>
    <style>
        /* スタイルは変更なし */
    </style>
</head>
<body>
    <p id="wordDisplay"></p>
    <div class="buttonContainer">
        <button onclick="submitAnswer('自分')">自分</button>
        <button onclick="submitAnswer('他人')">他人</button>
    </div>
    
    <script>
        var wordList = [
            { word: "中学生", correctChoice: "自分" },
            { word: "教師", correctChoice: "他人" },
            { word: "生徒", correctChoice: "自分" },
            { word: "他者", correctChoice: "他人" }
        ];

        var currentWordIndex = 0;
        var attendance_number = "{{ attendance_number }}";
        var startTime; // 各単語の開始時間を保存するための変数
        var timeTakenCounter = 1; // timeTaken1, timeTaken2 などを数える変数

        function displayNextWord() {
            document.getElementById('wordDisplay').innerText = wordList[currentWordIndex].word;
            startTime = new Date().getTime() / 1000;
        }

        function submitAnswer(choice) {
            var endTime = new Date().getTime() / 1000;
            var timeTaken = endTime - startTime;

            // ここで choice と正解を比較して、正解なら次のワードに進む
            var correctChoice = wordList[currentWordIndex].correctChoice;

            if (choice === correctChoice) {
                // 正解の場合
                currentWordIndex++;

                // ワードがまだ残っていれば表示
                if (currentWordIndex < wordList.length) {
                    displayNextWord();
                } else {
                    // ワードがなくなったら終了などの処理をここに追加
                   
                    // ここで POST リクエストを送信
                    var form = document.createElement('form');
                    form.method = 'POST';
                    form.action = '/test';
                    
                    var inputAttendanceNumber = document.createElement('input');
                    inputAttendanceNumber.type = 'hidden';
                    inputAttendanceNumber.name = 'attendance_number';
                    inputAttendanceNumber.value = attendance_number;
                    form.appendChild(inputAttendanceNumber);

                    // timeTaken1, timeTaken2, ... をフォームに追加
                    var inputTimeTaken = document.createElement('input');
                    inputTimeTaken.type = 'hidden';
                    inputTimeTaken.name = 'timeTaken' + timeTakenCounter;
                    inputTimeTaken.value = timeTaken;
                    form.appendChild(inputTimeTaken);

                    document.body.appendChild(form);
                    form.submit();
                }

                timeTakenCounter++; // 次のtimeTaken変数の番号へ進む
            } else {
                // 不正解の場合は何もしないか、メッセージを表示するなどの処理をここに追加
              
            }
        }

        // 初回表示
        displayNextWord();
    </script>
</body>
</html>
